<ng-template #additionalFiltersTemplate>
  <form (ngSubmit)="closeFiltersModal()" [formGroup]="hiddenFormGroup">
    <div class="block mb-3">
      <div class="flex items-center">
        <tui-input [tuiTextfieldSize]="'l'" class="grow me-2" [tuiAutoFocus]="true" [formControl]="query">
          <ng-container i18n>Filtra prenotazioni</ng-container>
          <input tuiTextfield>
        </tui-input>
      </div>
    </div>

    <div class="block mb-3">
      <app-reservation-status-select [showCleaner]="true" [inputSize]="'l'" [formControl]="status">
        <ng-container i18n>Stato</ng-container>
      </app-reservation-status-select>
    </div>

    <button tuiButton appearance="primary" type="submit">
      <ng-container i18n>Chiudi</ng-container>
    </button>
  </form>
</ng-template>

<div class="flex flex-wrap items-center">
  <div class="col-12 md:col-6">
    <app-reservation-date-select [formControl]="date">
      <ng-container i18n>Data</ng-container>
    </app-reservation-date-select>
  </div>

  <div class="col-11 md:col-5 px-1">
    <app-reservation-turn-select [showCleaner]="true" [filters]="{date: dateStr()}" [inputSize]="'m'"
      style="min-width: 150px;" class="mx-2" [formControl]="turn">
      <ng-container i18n>Turno</ng-container>
    </app-reservation-turn-select>
  </div>

  <div class="col-1">
    <button (click)="fireModal(additionalFiltersTemplate)" type="button" [showLoader]="loading" tuiIconButton
      appearance="flat">
      <mat-icon>filter_alt</mat-icon>
    </button>
  </div>

  <div class="col-12">
    @if(status.value){
      <app-chip (removeClick)="status.patchValue(null)">
        <ng-container i18n>Stato</ng-container>: <app-reservation-status [status]="status.value"></app-reservation-status>
      </app-chip>
    }

    @if(query.value){
      <app-chip (removeClick)="query.patchValue(null)">
        <ng-container i18n>Ricerca per</ng-container>: {{ query.value }}
      </app-chip>
    }
  </div>
</div>

<ng-content></ng-content>

<tui-table-pagination class="my-2" [items]="[10, 20, 50, 100]" [total]="data?.metadata?.total_count ?? 0"
  (paginationChange)="paginationChange($event)">
</tui-table-pagination>

<div class="flex items-center mb-2">
  <a routerLink="export" tuiLink>
    <span class="flex items-center">
      <mat-icon>download_file</mat-icon>
      <ng-container i18n>Esporta prenotazioni</ng-container>
    </span>
  </a>
</div>

@if(dateStr()) {
<app-reservation-tables-summary [showLoader]="false"
  [filters]="{ date: dateStr() ?? '' }"></app-reservation-tables-summary>
}